#!/usr/bin/bash

echo "Discos disponibles para trabajar"
echo "Seleccionar uno: /dev/sdX"
echo 
echo

fdisk -l | grep Dis | cut -d "," -f1
echo
# en unidad se debe escribir el nombre y direccion del disco "/dev/sdX
read unidad

tamanio=$(fdisk -l | grep $unidad | grep bytes | cut -d ',' -f 3 | cut -d ' ' -f 2)

home=$((tamanio/2))
(

# arranque del bios
# particion 1 
echo o
echo n
echo p
echo
echo
echo +1M

# Formato Bios Boot
echo t
echo 4

# EFI
# particion 2
echo n
echo p
echo
echo
echo +100M

#home
# particion 3
echo n 		#nueva particion
echo p 		#tipo particion
echo		#nro de particion
echo		#primer sector
echo $home	#ultimo sector

#raiz
# particion 4
echo n
echo p
echo
echo 
echo

echo w
) | fdisk $unidad 

echo "======Formateando particiones ======"

mkfs.fat -F32 "$unidad"2
mkfs.ext4 "$unidad"3
mkfs.ext4 "$unidad"4

echo "=====Montando unidades======="

mount "$unidad"4 /mnt
mkdir -p /mnt/home
mount "$unidad"3 /mnt/home
mkdir -p /mnt/boot/EFI
mount "$unidad"2 /mnt/boot/EFI

echo " Instalar paquetes "
./paquetes
